Threat Model — WireGuard VPN Infrastructure
Цель документа
Данный threat model описывает основные угрозы, риски и меры защиты
для VPN-инфраструктуры на базе WireGuard.

Документ отражает подход Security Engineering к проектированию
и эксплуатации защищённых сетевых сервисов.

Архитектурный контекст
VPN-сервер развернут на Linux-хосте (Docker-контейнер)
Клиенты подключаются из сетей с NAT (домашние и мобильные сети)
Используется протокол WireGuard (UDP)
Активы (Assets)
Конфиденциальность VPN-трафика клиентов
Приватные ключи WireGuard (серверные и клиентские)
Доступность VPN-сервиса
Сетевая инфраструктура сервера
Потенциальные угрозы
1. Компрометация приватного ключа клиента
Риск: злоумышленник получает доступ к VPN
Влияние: несанкционированный доступ к сети

Меры защиты:

Ограничение AllowedIPs для каждого клиента
Возможность быстрой ротации ключей
Отсутствие хранения ключей в репозитории
2. MITM-атаки при установке соединения
Риск: перехват или подмена трафика
Влияние: нарушение конфиденциальности

Меры защиты:

Использование криптографии WireGuard (Noise protocol)
Аутентификация только по ключам
Отсутствие password-based access
3. DDoS / Flood атаки на UDP-порт VPN
Риск: отказ в обслуживании
Влияние: потеря доступности сервиса

Меры защиты:

Firewall (iptables / nftables)
Ограничение источников подключения
Возможность rate limiting на уровне хоста
4. Ошибки конфигурации (MTU, NAT)
Риск: нестабильное соединение или утечка трафика
Влияние: деградация сервиса, потеря доверия

Меры защиты:

Явная настройка MTU
Использование PersistentKeepalive
Контроль применения конфигурации через wg syncconf
5. Компрометация VPN-сервера
Риск: полный контроль над инфраструктурой
Влияние: критическое

Меры защиты:

Отключён root-доступ по паролю
Минимизация сервисов на хосте
Разделение хоста и контейнера
Регулярные обновления системы
Выводы
Безопасность VPN — это не только шифрование, но и корректная эксплуатация
Основные риски связаны с управлением ключами и конфигурацией
Threat modeling позволяет выявлять проблемы до возникновения инцидентов
Документ может быть расширен по мере развития инфраструктуры.
